# MASTER_docking_pyrosetta.py
Using Pyrosetta to create a large number of similar docking geometries as input protein dimer, then use master to find the interfaces, which are most likely designable according to examples from proteins in the pdb.

## Important notes:
1. With 1/10th of current library, search takes maybe 10 seconds after first loading of library. But with full library, probably too slow. I tested with two alpha-helical fragments as query structures if searching against every 10th structure in database or every 13th (should be very different subsets) makes a qualitative difference. It didn't. Best positions give hundreds of hits already for the 1/13th subset. Therefore looking at only 1/10th of the databse makes sense for this search. But something to keep in mind, if more rare motifs are to be run.

2. The RMSD cutoff is currently set to 1.2. With lower cutoffs, almost no hits were found, which might be a function of one of the search fragments itself being a bit unusual in backbone conformation. This value might have to be adjusted up/down for each search, should there be too many or too few hits. 

3. For the two helical fragments case, it took about 7 seconds for each search (vs. 1/10th of the database, see above) on Oppenheimer on one kernel. With all 6 DOF and 4 steps for each 4096 structures were generated and had to be searched against the database. First parts of the script, making the 4096 structures and generating the pds files for the MASTER search took only a few minutes. Longest part is 7 sec * 4096 query structures = 28 672 secs ==  478 min == 7.96 hrs. This makes it basically an overnight run.

4. To make this a convenient tool to be applied briefly before starting a longer Rosetta design run, the run-time needed to be shorter and therefore a very crude multithreading approach was implemented. There is now a partial version of the script setting up the different search geometries and their pds files while not starting the actual MASTER search process yet. Then the second partial script to actually do the MASTER searches can be run with python SCRIPT X Y with Y being the number of subsets the query structures are split into and X being the Xths subset (starting with 1). That way  python SCRIPT 1 10 > 1.log & .... to python SCRIPT 10 10 > 10.log & can be started from commandline in parallel processes each running on its on kernel (tested 10 on Oppi; worked fine). Seperate output .csv files are created, but can very easily be concatenated with pandas later into one DataFrame for analysis just like before. This cut the total processing time for the same task from above to under 2 hrs.

5. For the one example of a cytochrome c dimer looking with MASTER at one helical fragment from each monomer, a Rosetta run with pack/relax/pack/relax was run on both, the original starting structure and the MASTER preferred starting structure. The master preferred structure was within the pack of the 1% best Rosetta structures (by interface REU). Comparing the resulting structures of both Rosetta runs, the run with the MASTER preferred starting structure resulted in much less backbone deviation from the starting structure (e.g. it sampled much more closely to the input) while giving overal better results. This most likely because the original run sampled broadly around the input structure and only finding the good backbone conformation around the MASTER preferred geometry in a few of the trajectories.
